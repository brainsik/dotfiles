#!/usr/bin/env zsh
set -eu -o pipefail

for cask in $(brew list --cask); do
    echo '* Checking' $cask
    current=$(brew info --cask $cask | perl -ne 'if (m|/Caskroom/[^/]+/(\S+)|) { print "$1\n"; }')
    latest=$(brew info --cask $cask | perl -ne 'if (m|'$cask': (\S+)|) { print("$1"); }')
    if [[ $current != $latest ]]; then
        echo "ðŸ¤¡  Upgrading $cask from $current to $latest:"
        echo "Bombing out so we can experiment with \`brew outdated --cask\`"
        exit 1
        brew upgrade --cask $cask
    fi
done
